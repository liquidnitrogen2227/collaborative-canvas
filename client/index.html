<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>Collaborative Canvas</title>
  <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
  <div id="onboarding" style="position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;background:rgba(0,0,0,0.55);color:#fff;z-index:1000;font-family:sans-serif;padding:24px;">
    <div style="background:#222;padding:24px;max-width:480px;width:90%;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,0.4);">
      <h2 style="margin-top:0">Welcome to Collaborative Canvas</h2>
      <ol style="font-size:14px;line-height:1.4;padding-left:18px;">
        <li>Pick a tool (Brush / Eraser / Line / Rect / Ellipse).</li>
        <li>Draw with 1 finger or mouse. Use Space + Drag (desktop) or two fingers to pan.</li>
        <li>Ctrl + Wheel (desktop) or pinch to zoom. Reset View to recenter.</li>
        <li>Undo / Redo affect the global history for everyone.</li>
        <li>Your cursor & strokes stream live to others in real time.</li>
      </ol>
      <label style="display:block;margin:12px 0 4px;">Choose a display name:</label>
      <input id="onboard-name" type="text" placeholder="e.g. Alex" maxlength="20" style="width:100%;padding:8px;border-radius:6px;border:1px solid #444;background:#111;color:#eee;" />
      <button id="onboard-start" style="margin-top:16px;width:100%;padding:10px 16px;border:none;border-radius:6px;background:#4caf50;color:#fff;font-weight:600;cursor:pointer;">Start Drawing</button>
      <p style="margin-top:12px;font-size:11px;opacity:0.75;">Tip: Eraser removes previous pixels; shapes preview until you release.</p>
    </div>
  </div>
  <!-- Mobile-friendly toolbar: layout adjusts via CSS media queries -->
  <div id="toolbar">
    <button id="toggle-toolbar" aria-label="Toggle toolbar" style="display:none">â˜°</button>
    <label class="hide-when-collapsed">ğŸ–Šï¸ Brush <input id="size" type="range" min="1" max="32" value="4" /></label>
    <input id="color" class="hide-when-collapsed" type="color" value="#000000" />
    <button id="tool-brush" data-tool="brush" class="tool active hide-when-collapsed">ğŸ–Šï¸ Brush</button>
    <button id="tool-eraser" data-tool="eraser" class="tool hide-when-collapsed">ğŸ§½ Eraser</button>
    <button id="tool-line" data-tool="line" class="tool hide-when-collapsed">ğŸ“ Line</button>
    <button id="tool-rect" data-tool="rect" class="tool hide-when-collapsed">â–­ Rect</button>
    <button id="tool-ellipse" data-tool="ellipse" class="tool hide-when-collapsed">â­• Ellipse</button>
      <button id="reset-view" class="hide-when-collapsed" title="Reset View">â¤¾ Reset</button>
    <button id="undo" title="Undo (Ctrl+Z)" class="hide-when-collapsed">â†¶ Undo</button>
    <button id="redo" title="Redo (Ctrl+Y)" class="hide-when-collapsed">â†· Redo</button>
    <span id="users" class="hide-when-collapsed" title="Online users">0 online</span>
    <button id="show-users" class="hide-when-collapsed" title="Show all users">ğŸ‘¥ Users</button>
    <button id="clear" class="hide-when-collapsed">Clear (local)</button>
    <button id="clear-global" class="hide-when-collapsed">Clear (global)</button>
  </div>
    <div id="stage">
      <canvas id="base"></canvas>
      <canvas id="live"></canvas>
      <canvas id="hud"></canvas>
    </div>
  <!-- Users Panel -->
  <div id="users-panel" style="display:none;position:fixed;top:64px;right:16px;z-index:1001;background:#fff;border:1px solid rgba(0,0,0,0.1);box-shadow:0 4px 16px rgba(0,0,0,0.15);border-radius:10px;min-width:240px;max-width:70vw;max-height:60vh;overflow:auto;">
    <div style="display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid rgba(0,0,0,0.06);">
      <strong>ğŸ‘¥ Users</strong>
      <button id="users-close" title="Close" style="border:none;background:transparent;font-size:18px;cursor:pointer;">âœ•</button>
    </div>
    <ul id="users-list" style="list-style:none;margin:0;padding:10px 12px;display:flex;flex-direction:column;gap:6px;"></ul>
  </div>
  <!-- Toasts -->
  <div id="toasts" style="position:fixed;bottom:16px;left:50%;transform:translateX(-50%);z-index:1002;display:flex;flex-direction:column;gap:8px;align-items:center;"></div>
  <script type="module" src="/build/bundle.js"></script>
  </body>
  </html>
